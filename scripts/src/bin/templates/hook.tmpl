#!/bin/bash

source $(dirname $0)/checkers/checkers-lib.sh

read old new ref < /dev/stdin

branch_name=$(echo $ref | awk 'BEGIN \{ FS = "/" } ; \{ print $NF }')

print_flags () \{
	print_flag_icon
	if [[ $# -eq 1 ]] 
		then echo "You won! The flag is "$1
	else
		echo "You won! The flags are"
		for flag in "$@"; do
			echo "$flag"
		done
	fi
	print_seperator
	# By default, we want to not push
	exit 1	
}

print_seperator

case $branch_name in
{{ for level in levels }}{level.branch})
    echo $old $new $ref | {level.solution_checker} && print_flags{{ for levelflag in level.flags }} "{levelflag}"{{ endfor }}
    ;;
{{ endfor }}*)
	echo "Unknown branchname $branch_name from ref $ref pushed! Are you sure you're pushing the correct branch?" && exit 1
esac
